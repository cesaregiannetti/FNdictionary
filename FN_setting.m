N=numel(x);
Nc=size(C,1);
dt=T(2)-T(1);
Tf=T(end);
Nt=length(T);
gamma=3.3333e-5;
eta1=0.2667;
eta2=0.4806;
eta3=60;
u0=4;
up=64;
uth=11.8;
alpha=uth-u0;
beta=up-u0;
eta=eta1/uth/up;
egetadt=exp(-gamma*eta3*dt);
etaueta=(1-egetadt)/eta3;
fun=@(u,w)eta*u.*(u-alpha).*(u-beta)+eta2*u.*w;
Jufun_u=[3*eta -2*eta*(alpha+beta) eta*alpha*beta];
Jufun_w=[0 0 eta2];